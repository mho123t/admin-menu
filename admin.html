<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø±ÙŠØ¯Ø§Ù†</title>
  <style>
    body { font-family: sans-serif; direction: rtl; text-align: center; background: #f5f5f5; }
    form { margin: 20px auto; padding: 20px; background: #fff; width: 350px; border-radius: 10px; box-shadow: 0 0 10px #ccc; }
    input, button { margin: 5px 0; padding: 10px; width: 90%; border-radius: 5px; border: 1px solid #ccc; }
    .product { background: #fff; padding: 10px; margin: 10px auto; width: 300px; border: 1px solid #ccc; border-radius: 10px; box-shadow: 0 0 5px #ddd; }
    img { width: 100%; height: 150px; object-fit: cover; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>ğŸ“¦ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… - Ø±ÙŠØ¯Ø§Ù†</h2>

  <form id="productForm">
    <input type="text" id="name_ar" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ" required />
    <input type="text" id="name_en" placeholder="Product Name (English)" required />
    <input type="number" id="price" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø¯Ø±Ù‡Ù…" required />
    <input type="text" id="image" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (URL)" required />
    <button type="submit">â• Ø£Ø¶Ù Ø§Ù„Ù…Ù†ØªØ¬</button>
  </form>

  <div id="productsList">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</div>

  <script type="module">
    const SUPABASE_URL = "https://vzizdvblkoqhvfmxmdre.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ6aXpkdmJsa29xaHZmbXhtZHJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwNDk4MTcsImV4cCI6MjA2NTYyNTgxN30.s2pICeyVF3YWl-PrISiHSanpbHL-JREt0RqlHG3nAHg";

    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    const form = document.getElementById('productForm');
    const nameAr = document.getElementById('name_ar');
    const nameEn = document.getElementById('name_en');
    const price = document.getElementById('price');
    const image = document.getElementById('image');
    const productsList = document.getElementById('productsList');

    form.onsubmit = async (e) => {
      e.preventDefault();
      const { error } = await supabase.from('products').insert([{
        name_ar: nameAr.value,
        name_en: nameEn.value,
        price: parseFloat(price.value),
        image: image.value
      }]);
      if (error) {
        alert("âŒ Ø®Ø·Ø£: " + error.message);
      } else {
        alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬!");
        form.reset();
        loadProducts();
      }
    };

    async function loadProducts() {
      const { data, error } = await supabase.from('products').select('*').order('id', { ascending: false });
      if (error) {
        productsList.innerText = "âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª";
        return;
      }
      productsList.innerHTML = "";
      data.forEach(product => {
        const div = document.createElement('div');
        div.className = 'product';
        div.innerHTML = `
          <img src="${product.image}" alt="${product.name_ar}" />
          <h3>${product.name_ar}</h3>
          <p>${product.price} Ø¯Ø±Ù‡Ù…</p>
          <button onclick="deleteProduct(${product.id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
        `;
        productsList.appendChild(div);
      });
    }

    window.deleteProduct = async function(id) {
      if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) {
        const { error } = await supabase.from('products').delete().eq('id', id);
        if (error) alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£");
        else loadProducts();
      }
    }

    loadProducts();
  </script>
</body>
</html>
